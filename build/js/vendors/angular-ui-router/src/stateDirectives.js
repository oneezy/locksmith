function parseStateRef(e,t){var r,i=e.match(/^\s*({[^}]*})\s*$/);if(i&&(e=t+"("+i[1]+")"),r=e.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!r||4!==r.length)throw new Error("Invalid state ref '"+e+"'");return{state:r[1],paramExpr:r[3]||null}}function stateContext(e){var t=e.parent().inheritedData("$uiView");return t&&t.state&&t.state.name?t.state:void 0}function $StateRefDirective(e,t){var r=["location","inherit","reload"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(i,a,n,c){var u=parseStateRef(n.uiSref,e.current.name),f=null,o=stateContext(a)||e.$current,s="FORM"===a[0].nodeName,v=s?"action":"href",l=!0,$={relative:o,inherit:!0},S=i.$eval(n.uiSrefOpts)||{};angular.forEach(r,function(e){e in S&&($[e]=S[e])});var p=function(t){if(t&&(f=t),l){var r=e.href(u.state,f,$),i=c[1]||c[0];return i&&i.$$setStateInfo(u.state,f),null===r?(l=!1,!1):void(a[0][v]=r)}};u.paramExpr&&(i.$watch(u.paramExpr,function(e){e!==f&&p(e)},!0),f=i.$eval(u.paramExpr)),p(),s||a.bind("click",function(r){var i=r.which||r.button;if(!(i>1||r.ctrlKey||r.metaKey||r.shiftKey||a.attr("target"))){var n=t(function(){e.go(u.state,f,$)});r.preventDefault(),r.preventDefault=function(){t.cancel(n)}}})}}}function $StateRefActiveDirective(e,t,r){return{restrict:"A",controller:["$scope","$element","$attrs",function(i,a,n){function c(){u()?a.addClass(v):a.removeClass(v)}function u(){return"undefined"!=typeof n.uiSrefActiveEq?e.$current.self===o&&f():e.includes(o.name)&&f()}function f(){return!s||equalForKeys(s,t)}var o,s,v;v=r(n.uiSrefActiveEq||n.uiSrefActive||"",!1)(i),this.$$setStateInfo=function(t,r){o=e.get(t,stateContext(a)),s=r,c()},i.$on("$stateChangeSuccess",c)}]}}$StateRefDirective.$inject=["$state","$timeout"],$StateRefActiveDirective.$inject=["$state","$stateParams","$interpolate"],angular.module("ui.router.state").directive("uiSref",$StateRefDirective).directive("uiSrefActive",$StateRefActiveDirective).directive("uiSrefActiveEq",$StateRefActiveDirective);