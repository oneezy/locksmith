!function(){"use strict";angular.module("angular-carousel").directive("rnCarousel",["$swipe","$window","$document","$parse","$compile","$rootScope",function(e,n,r,a,o,t){var i=0,u=75,s=.05,c=3,l=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame;return{restrict:"A",scope:!0,compile:function(d,f){var x,v,p=d.children()[0].attributes,I=!1,m=!1,g=!1;return d.addClass("rn-carousel-slides"),d.children().addClass("rn-carousel-slide"),["ng-repeat","data-ng-repeat","x-ng-repeat"].every(function(e){var n=p[e];if(angular.isDefined(n)){var r=n.value.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),a=r[3];if(x=r[1],v=r[2],x)return angular.isDefined(f.rnCarouselBuffered)&&(m=!0,n.value=x+" in "+v+"|carouselSlice:carouselBufferIndex:carouselBufferSize",a&&(n.value+=" track by "+a)),I=!0,!1}return!0}),function(d,f,x){function p(){for(var e=[],n=0;X>n;n++)e[n]=n;d.carouselIndicatorArray=e}function h(){var e=H.children();return R=0===e.length?H[0].getBoundingClientRect().width:e[0].getBoundingClientRect().width}function $(){J.css("width","100%");var e=h();e&&J.css("width",e+"px")}function w(e){isNaN(e)&&(e=d.carouselIndex*R),V=e;var n=-Math.round(V);n+=d.carouselBufferIndex*R,H[0].style[q]=W?"translate3d("+n+"px, 0, 0)":"translate("+n+"px, 0)"}function b(){var e,n;T&&(e=Date.now()-P,n=T*Math.exp(-e/u),n>c||-c>n?(w(j-n),l(b)):B(j/R))}function y(e){return e>=X?X:0>=e?0:e}function C(){var e=0,n=(d.carouselBufferSize-1)/2;m&&(e=d.carouselIndex<=n?0:X<d.carouselBufferSize?0:d.carouselIndex>X-d.carouselBufferSize?X-d.carouselBufferSize:d.carouselIndex-n),d.carouselBufferIndex=e}function B(e,n){return isNaN(e)&&(e=d.carouselIndex),n?(V=e*R,void M(null,null,!0)):(d.carouselIndex=y(e),C(),"$apply"!==t.$$phase&&"$digest"!==t.$$phase&&(g?d.$apply():d.$digest()),void w())}function S(){return s*R}function z(e){Y=!0,M({x:e.clientX,y:e.clientY},e)}function D(e){var n=e;return 0===d.carouselIndex?n=Math.max(-S(),n):d.carouselIndex===X-1&&(n=Math.min((X-1)*R+S(),n)),n}function A(e){return r.bind("mouseup",z),E=!0,O=e.x,T=0,P=Date.now(),!1}function k(e){var n,r;return E&&(n=e.x,r=O-n,(r>2||-2>r)&&(Y=!0,O=n,l(function(){w(D(V+r))}))),!1}function M(e,n,a){if(!n||Y){r.unbind("mouseup",z),E=!1,Y=!1,j=V;var o=S(),t=d.carouselIndex*R,i=t-j,u=-Math[i>=0?"ceil":"floor"](i/R),s=Math.abs(i)>o;u+d.carouselIndex>=X&&(u=X-1-d.carouselIndex),u+d.carouselIndex<0&&(u=-d.carouselIndex);var c=s?u:0;return j=(c+d.carouselIndex)*R,T=j-V,P=Date.now(),a&&(T=V-t),l(b),!1}}function N(){var e,n=document.createElement("p"),r={webkitTransform:"-webkit-transform",msTransform:"-ms-transform",transform:"transform"};document.body.insertBefore(n,null);for(var a in r)void 0!==n.style[a]&&(n.style[a]="translate3d(1px,1px,1px)",e=window.getComputedStyle(n).getPropertyValue(r[a]));return document.body.removeChild(n),void 0!==e&&e.length>0&&"none"!==e}function F(){$(),B()}i++;var R,q,E,O,T,j,P,V=0,X=0,Y=!1,G=!0,H=f.wrap("<div id='carousel-"+i+"' class='rn-carousel-container'></div>"),J=H.parent();if((angular.isDefined(x.rnCarouselIndicator)||angular.isDefined(x.rnCarouselControl))&&(p(),d.$watch("carouselIndex",function(e){d.indicatorIndex=e,d.carouselExposedIndex=e}),d.$watch("indicatorIndex",function(e){B(e,!0)})),angular.isDefined(x.rnCarouselPreventAnimation)&&(G=!1),d.$watch("carouselExposedIndex",function(e){B(e,!0)}),angular.isDefined(x.rnCarouselIndicator)){var K=o("<div id='carousel-"+i+"-indicator' index='indicatorIndex' items='carouselIndicatorArray' rn-carousel-indicators class='rn-carousel-indicator'></div>")(d);J.append(K)}if(angular.isDefined(x.rnCarouselControl)){var L=o("<div id='carousel-"+i+"-controls' index='indicatorIndex' items='carouselIndicatorArray' rn-carousel-controls class='rn-carousel-controls'></div>")(d);J.append(L)}if(d.carouselBufferIndex=0,d.carouselBufferSize=5,d.carouselIndex=0,x.rnCarouselIndex){var Q=function(e){U.assign(d.$parent,e)},U=a(x.rnCarouselIndex);angular.isFunction(U.assign)?(d.$watch("carouselIndex",function(e){Q(e)}),d.carouselIndex=U(d),d.$parent.$watch(U,function(e){void 0!==e&&(e>=X?(e=X-1,Q(e)):0>e&&(e=0,Q(e)),B(e,G))}),g=!0):isNaN(x.rnCarouselIndex)||(d.carouselIndex=parseInt(x.rnCarouselIndex,10))}I?d.$watchCollection(v,function(e){X=0,angular.isArray(e)?X=e.length:angular.isObject(e)&&(X=Object.keys(e).length),p(),R||$(),B(d.carouselIndex)}):(X=f.children().length,p(),$()),x.$observe("rnCarouselSwipe",function(n){"false"!==n&&"off"!==n?e.bind(H,{start:A,move:k,end:M,cancel:function(e){M({},e)}}):H.unbind()}),g||B(d.carouselIndex),q="transform",["webkit","Moz","O","ms"].every(function(e){var n=e+"Transform";return"undefined"!=typeof document.body.style[n]?(q=n,!1):!0});var W=N(),Z=angular.element(n);Z.bind("orientationchange",F),Z.bind("resize",F),d.$on("$destroy",function(){r.unbind("mouseup",z),Z.unbind("orientationchange",F),Z.unbind("resize",F)})}}}}])}();